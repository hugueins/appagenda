<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Crear Cuenta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form [formGroup]="registerForm" (ngSubmit)="register()">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Registro de Usuario</ion-card-title>
        <ion-card-subtitle>Complete los siguientes campos para crear su cuenta</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <!-- Cédula -->
        <ion-item>
          <ion-label position="floating">Cédula</ion-label>
          <ion-input 
            type="text" 
            formControlName="cedula"
            inputmode="numeric"
            maxlength="10">
          </ion-input>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('cedula')?.touched && registerForm.get('cedula')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('cedula')?.errors?.['required']">
            La cédula es requerida
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('cedula')?.errors?.['minlength'] || registerForm.get('cedula')?.errors?.['maxlength']">
            La cédula debe tener 10 dígitos
          </ion-text>
        </div>

        <!-- Nombre -->
        <ion-item>
          <ion-label position="floating">Nombre</ion-label>
          <ion-input type="text" formControlName="nombre"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('nombre')?.touched && registerForm.get('nombre')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('nombre')?.errors?.['required']">
            El nombre es requerido
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('nombre')?.errors?.['minlength']">
            El nombre debe tener al menos 2 caracteres
          </ion-text>
        </div>

        <!-- Apellido -->
        <ion-item>
          <ion-label position="floating">Apellido</ion-label>
          <ion-input type="text" formControlName="apellido"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('apellido')?.touched && registerForm.get('apellido')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('apellido')?.errors?.['required']">
            El apellido es requerido
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('apellido')?.errors?.['minlength']">
            El apellido debe tener al menos 2 caracteres
          </ion-text>
        </div>

        <!-- Correo -->
        <ion-item>
          <ion-label position="floating">Correo electrónico</ion-label>
          <ion-input type="email" formControlName="correo"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('correo')?.touched && registerForm.get('correo')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('correo')?.errors?.['required']">
            El correo es requerido
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('correo')?.errors?.['email']">
            Ingrese un correo válido
          </ion-text>
        </div>

        <!-- Contraseña -->
        <ion-item>
          <ion-label position="floating">Contraseña</ion-label>
          <ion-input 
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password">
          </ion-input>
          <ion-button 
            slot="end" 
            fill="clear"
            (click)="togglePassword()"
            type="button">
            <ion-icon [name]="showPassword ? 'eye-off' : 'eye'"></ion-icon>
          </ion-button>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('password')?.errors?.['required']">
            La contraseña es requerida
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('password')?.errors?.['minlength']">
            La contraseña debe tener al menos 6 caracteres
          </ion-text>
        </div>

        <!-- Frase Secreta -->
        <ion-item>
          <ion-label position="floating">Frase secreta (para recuperar contraseña)</ion-label>
          <ion-input type="text" formControlName="fraseSecreta"></ion-input>
        </ion-item>
        <div class="error-message" *ngIf="registerForm.get('fraseSecreta')?.touched && registerForm.get('fraseSecreta')?.invalid">
          <ion-text color="danger" *ngIf="registerForm.get('fraseSecreta')?.errors?.['required']">
            La frase secreta es requerida
          </ion-text>
          <ion-text color="danger" *ngIf="registerForm.get('fraseSecreta')?.errors?.['minlength']">
            La frase secreta debe tener al menos 6 caracteres
          </ion-text>
        </div>

        <ion-button 
          expand="block" 
          type="submit" 
          class="ion-margin-top"
          [disabled]="registerForm.invalid">
          Crear Cuenta
        </ion-button>

        <div class="ion-text-center ion-margin-top">
          <ion-text color="medium">
            ¿Ya tienes una cuenta?
          </ion-text>
          <ion-button fill="clear" size="small" (click)="goToLogin()">
            Inicia sesión aquí
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </form>
</ion-content>